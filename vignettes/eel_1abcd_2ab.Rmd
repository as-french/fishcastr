---
title: "An example of seasonal forecast development for European silver eel: Part I of IV"
subtitle: 
output: rmarkdown::html_vignette
vignette: >
  %\VignetteEncoding{UTF-8}
  %\VignetteIndexEntry{An example of seasonal forecast development for European silver eel: Part I of IV}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# INTRODUCTION

This document highlights the package location of all raw and model derived catchment environmental data and corresponding model calibrations (i.e., "hydrologic", "water temperature" and "migration preparedness" elements of the model chain) for the European silver eel (*Anguilla anguilla*) models presented in the accompanying manuscript. A separate vignette, "eel_2c.Rmd", describes fish count model fitting and checking procedure.

All R scripts required to produce the catchment environmental data highlighted in this document (including calibrations; e.g., the GR4J hydrologic model calibration that was used to produce `fishcastr::data_Feeagh_discharge`) are contained in the `data_raw` folder of the package and are named accordingly (e.g., `data_raw/data_Feeagh_discharge.R`. To access the raw external data (e.g., netcdf .nc files) required to run some of the `data_raw` scripts for climate data bias adjustment, download the `extdata` folder from the Marine Institute and paste it into the `fishcastr/inst/` folder and set working directory `setwd()` to the location of the R package.

The following sections correspond to numbered items in **Figure 1** of the accompanying manuscript.

# (1) DATA PROVENANCE AND PRE-PROCESSING

## (1a) Compile catchment specific data

```{r catchment_specific_data, out.width="100%", eval=FALSE}
# ---------------------------------------------------------------------------------------------------------- #
# FISH COUNTS (see: data-raw/data_ssmolt.R ../data_seel.R  ../data_stsmolt.R) ----
data_seel <- fishcastr::data_seel
data_seel$year <-lubridate::year(data_seel$date)
data_seel$yday <-lubridate::yday(data_seel$date)
data_seel <- data_seel[data_seel$year >= 1981,]

# calculate average per year day
mean_daily_count <- tapply(data_seel$seel,INDEX = data_seel$yday,FUN = mean,na.rm = TRUE)
lower_pct <- tapply(data_seel$seel,INDEX = data_seel$yday,FUN = quantile, probs = 0.025,na.rm = TRUE)
upr_pct <- tapply(data_seel$seel,INDEX = data_seel$yday,FUN = quantile,probs = 0.975,na.rm = TRUE)
df_mean <- data.frame("yday" = names(mean_daily_count),
                        "mean_count" = as.vector(mean_daily_count),
                        "lwr" = as.vector(lower_pct),
                        "upr" = as.vector(upr_pct))
df_counts <- merge(data_seel,df_mean, by = "yday",all.x = TRUE)
df_counts_order <- df_counts[order(df_counts$date),]

  # for plotting clarity replace zeros with NAs
  ####
      df_counts_order$seel[1] <- ifelse(df_counts_order$seel[1] == 0 & df_counts_order$seel[2] == 0, NA, df_counts_order$seel[1])

      for(j in 2:(length(df_counts_order$seel)-1)){
        df_counts_order$seel[j] <- ifelse(df_counts_order$seel[j] == 0 & df_counts_order$seel[j-1] == 0 & df_counts_order$seel[j+1] == 0, NA, df_counts_order$seel[j])
      }

      df_counts_order$seel[length(df_counts_order$seel)] <- ifelse(df_counts_order$seel[length(df_counts_order$seel)] == 0 & df_counts_order$seel[length(df_counts_order$seel)-1] == 0, NA, df_counts_order$seel[length(df_counts_order$seel)])
  ####

# set plot colours
rgb_col <- col2rgb("black")
col_alpha_black <- rgb(red = rgb_col[1], green = rgb_col[2], blue = rgb_col[3],
                             alpha = 40, maxColorValue = 255)
rgb_col <- col2rgb("red")
col_alpha_red <- rgb(red = rgb_col[1], green = rgb_col[2], blue = rgb_col[3],
                             alpha = 60, maxColorValue = 255)
# plot data
dirName <- paste0(system.file("vignettes", package = "fishcastr"),"/figure/")
dir.create(dirName, showWarnings = TRUE, mode = "0777")
png(filename = "figure/catchment_specific_data-1.png", height = 2300, width = 1500, res =300)
dev.new()
par(mfcol = c(13,3),oma = c(8,4,1,1), mar = c(0.5,0.5,0.1,0.1))
for(i in unique(df_counts_order$year)) {
#  ylims <- c(0,max(c(max(df_counts_order$mean_count[df_counts_order$year == i],na.rm = TRUE),
#                   max(df_counts_order$seel[df_counts_order$year == i],na.rm = TRUE))))
      low_yvals <- ifelse(is.na(df_counts_order$seel[df_counts_order$year == i]),NA, 0)
      
  ylims = c(0,200)
  xlims <- c(180,365)
  plot(df_counts_order$yday[df_counts_order$year == i],
       df_counts_order$mean_count[df_counts_order$year == i], col = NULL, ylim = ylims,xlab = "", ylab = "",xaxt = "n",yaxt = "n", xlim = xlims)
  title(main = i,adj = 0.9, line = -1)
  if(i %in% c(1993,2006,2019)){
    axis(side = 1, tck = 0.1)
  }
    if(i %in% c(1981:1993)){
    axis(side = 2, tck = 0.1)
  }
  # polygons
  fishcastr::step_style_polygon(xvals = df_counts_order$yday[df_counts_order$year == i & df_counts_order$mean_count > 0],
                     y_vals_low = 0,
                     y_vals_up = df_counts_order$mean_count[df_counts_order$year == i & df_counts_order$mean_count > 0],
                     col_alpha_rgb = col_alpha_black, border = NA)
  
    fishcastr::step_style_polygon(xvals = df_counts_order$yday[df_counts_order$year == i],
                     y_vals_low = low_yvals,
                     y_vals_up = df_counts_order$seel[df_counts_order$year == i],
                     col_alpha_rgb = col_alpha_red, border = "red")
  
}
mtext(side = 1,text = "yday",outer = TRUE,line = 2)
mtext(side = 2,text = "counts",outer = TRUE,line = 2)
legend("bottomright", legend = c("count","1981 - 2019 mean"),col = c(col_alpha_red,col_alpha_black), pch = c(15,15),bty = "n",inset = c(0.1,-2.5), xpd = NA, cex = 1.5)
dev.off()
knitr::include_graphics(path = "figure/catchment_specific_data-1.png")
# ---------------------------------------------------------------------------------------------------------- #
# WATER TEMPERATURE (see: data-raw/data_Feeagh2m_temp.R) ----
data_Feeagh2m_temp <- fishcastr::data_Feeagh2m_temp
data_Feeagh2m_temp$year <-lubridate::year(data_Feeagh2m_temp$date)
data_Feeagh2m_temp$yday <-lubridate::yday(data_Feeagh2m_temp$date)

# calculate average per year day
mean_daily_temp <- tapply(data_Feeagh2m_temp$Water_Temp_2m,INDEX = data_Feeagh2m_temp$yday,FUN = mean,na.rm = TRUE)
lower_pct <- tapply(data_Feeagh2m_temp$Water_Temp_2m,INDEX = data_Feeagh2m_temp$yday,FUN = quantile, probs = 0.025,na.rm = TRUE)
upr_pct <- tapply(data_Feeagh2m_temp$Water_Temp_2m,INDEX = data_Feeagh2m_temp$yday,FUN = quantile,probs = 0.975,na.rm = TRUE)
df_mean <- data.frame("yday" = names(mean_daily_temp),
                        "mean_temp" = as.vector(mean_daily_temp),
                        "lwr" = as.vector(lower_pct),
                        "upr" = as.vector(upr_pct))
df_temps <- merge(data_Feeagh2m_temp,df_mean, by = "yday",all.x = TRUE)
df_temps_order <- df_temps[order(df_temps$date),]

# set plot colours
rgb_col <- col2rgb("black")
col_alpha_black <- rgb(red = rgb_col[1], green = rgb_col[2], blue = rgb_col[3],
                             alpha = 40, maxColorValue = 255)
# plot data
dev.new()
png(filename = "figure/catchment_specific_data-2.png")
par(mfcol = c(4,4),oma = c(10,4,1,1), mar = c(1,0.5,0.1,0.1))
for(i in unique(df_temps_order$year)) {
  ylims <- c(0,max(c(max(df_temps_order$upr[df_temps_order$year == i],na.rm = TRUE),
                   max(df_temps_order$Water_Temp_2m[df_temps_order$year == i], na.rm = TRUE))))
  xlims <- c(1,365)
  plot(df_temps_order$yday[df_temps_order$year == i],
       df_temps_order$mean_temp[df_temps_order$year == i], col = NULL, ylim = ylims,xlab = "", ylab = "",xaxt = "n",yaxt = "n", xlim = xlims)
  title(main = i,adj = 0.9, line = -1)
  if(i %in% c(2007,2011,2015,2019)){
    axis(side = 1, tck = 0.1)
  }
    if(i %in% c(2004:2007)){
    axis(side = 2, tck = 0.1)
  }
  # polygons
  step_style_polygon(xvals = df_temps_order$yday[df_temps_order$year == i],
                     y_vals_low = df_temps_order$lwr[df_temps_order$year == i],
                     y_vals_up = df_temps_order$upr[df_temps_order$year == i],
                     col_alpha_rgb = col_alpha_black, border = NA)

  lines(df_temps_order$yday[df_temps_order$year == i],df_temps_order$Water_Temp_2m[df_temps_order$year == i], lty = 1, lwd = 2, col = "red")

}
mtext(side = 1,text = "yday",outer = TRUE,line = 2)
mtext(side = 2,text = expression("Water temperature ("*~degree*C*")"),outer = TRUE,line = 2)
legend("bottomright", legend = c("water temperature","2004 - 2019 mean"),col = c("red",col_alpha_black), pch = c(NA,15),lty = c(1,NA),bty = "n",inset = c(0.1,-0.9), xpd = NA, cex = 1.5)
dev.off()
knitr::include_graphics(path = "figure/catchment_specific_data-2.png")

# ---------------------------------------------------------------------------------------------------------- #
# CATCHMENT DISCHARGE (see: data-raw/data_Feeagh_discharge.R) ----
data_Feeagh_discharge <- fishcastr::data_Feeagh_discharge
data_Feeagh_discharge$year <-lubridate::year(data_Feeagh_discharge$date)
data_Feeagh_discharge$yday <-lubridate::yday(data_Feeagh_discharge$date)
data_Feeagh_discharge <- data_Feeagh_discharge[data_Feeagh_discharge$year >= 1981 & data_Feeagh_discharge$year <= 2019,]

# calculate average per year day
mean_daily_discharge <- tapply(data_Feeagh_discharge$discharge_m3.s,INDEX = data_Feeagh_discharge$yday,FUN = mean,na.rm = TRUE)
lower_pct <- tapply(data_Feeagh_discharge$discharge_m3.s,INDEX = data_Feeagh_discharge$yday,FUN = quantile, probs = 0.025,na.rm = TRUE)
upr_pct <- tapply(data_Feeagh_discharge$discharge_m3.s,INDEX = data_Feeagh_discharge$yday,FUN = quantile,probs = 0.975,na.rm = TRUE)
df_mean <- data.frame("yday" = names(mean_daily_discharge),
                        "mean_discharge" = as.vector(mean_daily_discharge),
                        "lwr" = as.vector(lower_pct),
                        "upr" = as.vector(upr_pct))
df_discharge <- merge(data_Feeagh_discharge,df_mean, by = "yday",all.x = TRUE)
df_discharge_order <- df_discharge[order(df_discharge$date),]

# set plot colours
rgb_col <- col2rgb("black")
col_alpha_black <- rgb(red = rgb_col[1], green = rgb_col[2], blue = rgb_col[3],
                             alpha = 40, maxColorValue = 255)
dev.new()
# plot data
png(filename = "figure/catchment_specific_data-3.png")
par(mfcol = c(13,3),oma = c(10,4,1,1), mar = c(1,0.5,0.1,0.1))
for(i in unique(df_discharge_order$year)) {
  ylims <- c(0,max(c(max(df_discharge_order$upr[df_discharge_order$year == i],na.rm = TRUE),
                   max(df_discharge_order$discharge_m3.s[df_discharge_order$year == i], na.rm = TRUE))))
  xlims <- c(1,365)
  plot(df_discharge_order$yday[df_discharge_order$year == i],
       df_discharge_order$mean_discharge[df_discharge_order$year == i], col = NULL, ylim = ylims,xlab = "", ylab = "",xaxt = "n",yaxt = "n", xlim = xlims)
  title(main = i,adj = 0.5, line = -1)
  if(i %in% c(1993,2006,2019)){
    axis(side = 1, tck = 0.1)
  }
    if(i %in% c(1981:1993)){
    axis(side = 2, tck = 0.1)
  }
  # polygons
  step_style_polygon(xvals = df_discharge_order$yday[df_discharge_order$year == i],
                     y_vals_low = df_discharge_order$lwr[df_discharge_order$year == i],
                     y_vals_up = df_discharge_order$upr[df_discharge_order$year == i],
                     col_alpha_rgb = col_alpha_black, border = NA)

  lines(df_discharge_order$yday[df_discharge_order$year == i],df_discharge_order$discharge_m3.s[df_discharge_order$year == i], lty = 1, lwd = 2, col = "blue")

}
mtext(side = 1,text = "yday",outer = TRUE,line = 2)
mtext(side = 2,text = expression(paste("Catchment discharge (","m"^"3", "/s)")),outer = TRUE,line = 2)
legend("bottomright", legend = c("Catchment discharge","1981 - 2019 mean"),col = c("blue",col_alpha_black), pch = c(NA,15),lty = c(1,NA),bty = "n",inset = c(0.1,-4.5), xpd = NA, cex = 1.5)
dev.off()
knitr::include_graphics(path = "figure/catchment_specific_data-3.png")

# ---------------------------------------------------------------------------------------------------------- #
# DATES AND LOCATION OF CATCHMENT ----
# dates <- data_seel$date
# latitude <- 53.932458
# longitude <- -9.575556
```

## (1b) Access lunar and solar data

```{r lunar_solar_data, eval=FALSE}
# ---------------------------------------------------------------------------------------------------------- #
# CALCULATE PHOTOPERIOD (see: R/photper_calc.R) ----
data_photper <- fishcastr::photper_calc(dates = fishcastr::data_seel[["date"]],
                                        latitude = 53.932458,
                                        longitude = -9.575556)
png(filename = "figure/lunar_solar_data-1.png")
plot(1:1000, data_photper[1:1000], type = "l", ylab = "photperiod (hours)", xlab = paste0("days after ",min(fishcastr::data_seel[["date"]])))
dev.off()
knitr::include_graphics(path = "figure/lunar_solar_data-1.png")

# ---------------------------------------------------------------------------------------------------------- #
# CATCHMENT MOONLIGHT EXPOSURE (see: R/lunar_light_exposure.R) ----
# subset of dates here as long to calculate
data_lunar <- fishcastr::lunar_light_exposure(date_of_interest = fishcastr::data_seel[["date"]][1:365],
                                              lat = 53.932458,
                                              lon = -9.575556,
                                              log_result = FALSE)
png(filename = "figure/lunar_solar_data-2.png")
plot(1:365, data_lunar[1:365], type = "l", ylab = "moonlight exposure",xlab = paste0("days after ",min(fishcastr::data_seel[["date"]])))
dev.off()
knitr::include_graphics(path = "figure/lunar_solar_data-2.png")
```

## (1c) Access climate data

```{r access_climate_data, eval=FALSE}
# ---------------------------------------------------------------------------------------------------------- #
# OBSERVATIONS (see: data-raw/data_met_obs/..)  ----
grid_met_obs_1979_2019 <- fishcastr::grid_met_obs_1979_2019
#visualizeR::temporalPlot(... = grid_met_obs_1979_2019$tas)
data_met_obs_1979_2019 <- fishcastr::convert_grid_to_dataframe(grid_obj = grid_met_obs_1979_2019)

png(filename = "figure/access_climate_data-1.png")
par(mfrow = c(3,1), mar = c(4,4,0.2,0.2))
plot(data_met_obs_1979_2019$dates1[1:1000],data_met_obs_1979_2019$tas[1:1000], type = "l",col = "red",xlab = "date", ylab = expression("2m air temperature ("*~degree*C*")"))
plot(data_met_obs_1979_2019$dates1[1:1000],data_met_obs_1979_2019$pr[1:1000], type = "l",col = "blue",xlab = "date", ylab = "total daily precipitation")
plot(data_met_obs_1979_2019$dates1[1:1000],data_met_obs_1979_2019$petH[1:1000], type = "l",col = "black",xlab = "date", ylab = "total daily potential evapotranspiration")
dev.off()
knitr::include_graphics(path = "figure/access_climate_data-1.png")
# ---------------------------------------------------------------------------------------------------------- #
# REANALYSIS (see: data-raw/grid_ERA5_reforecasts/..) ----
# raw grid (Re-forecasts and archived operational forecast years; 1993 - 2019)
grid_ERA5_1979_2019_Jan_raw <- fishcastr::grid_ERA5_1979_2019_Jan_raw
#visualizeR::temporalPlot(... = grid_ERA5_1979_2019_Jan_raw$tas)
data_ERA5_1979_2019_Jan_raw <- fishcastr::convert_grid_to_dataframe(grid_obj = grid_ERA5_1979_2019_Jan_raw)
png(filename = "figure/access_climate_data-2.png")
par(mfrow = c(3,1), mar = c(4,4,0.2,0.2))
plot(data_ERA5_1979_2019_Jan_raw$dates1[1:1000],data_ERA5_1979_2019_Jan_raw$tas[1:1000], type = "l",col = "red",xlab = "date", ylab = expression("2m air temperature ("*~degree*C*")"))
plot(data_ERA5_1979_2019_Jan_raw$dates1[1:1000],data_ERA5_1979_2019_Jan_raw$pr[1:1000], type = "l",col = "blue",xlab = "date", ylab = "total daily precipitation")
plot(data_ERA5_1979_2019_Jan_raw$dates1[1:1000],data_ERA5_1979_2019_Jan_raw$petH[1:1000], type = "l",col = "black",xlab = "date", ylab = "total daily potential evapotranspiration")
dev.off()
knitr::include_graphics(path = "figure/access_climate_data-2.png")

# ---------------------------------------------------------------------------------------------------------- #
# SEASONAL CLIMATE FORECAST (Re-forecasts and archived operational forecasts 1993 - 2019) ----
# (see: data-raw/grid_SEAS5_reforecasts/..)
grid_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw <- fishcastr::grid_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw
data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw <- fishcastr::convert_grid_to_dataframe(grid_obj = grid_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw)

# set plot colours
rgb_col <- col2rgb("red")
col_alpha_red <- rgb(red = rgb_col[1], green = rgb_col[2], blue = rgb_col[3],
                             alpha = 40, maxColorValue = 255)
# set plot colours
rgb_col <- col2rgb("blue")
col_alpha_blue <- rgb(red = rgb_col[1], green = rgb_col[2], blue = rgb_col[3],
                             alpha = 40, maxColorValue = 255)
rgb_col <- col2rgb("black")
col_alpha_black <- rgb(red = rgb_col[1], green = rgb_col[2], blue = rgb_col[3],
                             alpha = 40, maxColorValue = 255)

png(filename = "figure/access_climate_data-3.png")
par(mfrow = c(3,1), mar = c(4,4,0.2,0.2))
plot(data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[1]][["dates1"]][1:211],
     data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[1]][["tas"]][1:211], type = "l",col = col_alpha_red,xlab = "date", ylab = expression("2m air temperature ("*~degree*C*")"), ylim = c(0,20))
for(i in 2:25){
  lines(data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[i]][["dates1"]][1:211],
     data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[i]][["tas"]][1:211], col = col_alpha_red)
}

plot(data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[1]][["dates1"]][1:211],
     data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[1]][["pr"]][1:211], type = "l",col = col_alpha_blue,xlab = "date", ylab = "total daily precipitation", ylim = c(0,30))
for(i in 2:25){
  lines(data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[i]][["dates1"]][1:211],
     data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[i]][["pr"]][1:211], col = col_alpha_blue)
}

plot(data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[1]][["dates1"]][1:211],
     data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[1]][["petH"]][1:211], type = "l",col = col_alpha_black,xlab = "date", ylab = "total daily potential evapotranspiration", ylim = c(0,4))
for(i in 2:25){
  lines(data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[i]][["dates1"]][1:211],
     data_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw[[i]][["petH"]][1:211], col = col_alpha_black)
}
dev.off()
knitr::include_graphics(path = "figure/access_climate_data-3.png")

#visualizeR::temporalPlot(... = grid_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_raw$pr)
```

## (1d) Pre-process climate data

```{r pre_process_climate_data, eval=FALSE}
# ---------------------------------------------------------------------------------------------------------- #
# REANALYSIS (bias corrected) ----
# SPRING (see: data-raw/grid_ERA5_reforecasts/grid_ERA5_1979_2019_Jan_bc.R)
grid_ERA5_1979_2019_Jan_bc <- fishcastr::grid_ERA5_1979_2019_Jan_bc
#visualizeR::temporalPlot(... = grid_ERA5_1979_2019_Jan_bc$tas)
# plot bias corrected and raw data alongside obs
grid_met_obs_1979_2019 <- fishcastr::grid_met_obs_1979_2019
grid_ERA5_1979_2019_Jan_raw <- fishcastr::grid_ERA5_1979_2019_Jan_raw
png(filename = "figure/pre_process_climate_data-1.png")
par(mfrow = c(1,1))
plot(grid_met_obs_1979_2019$tas$Data[1:365], type = "l", col = "black", ylab = expression("2m air temperature ("*~degree*C*")"), xlab = paste0("days after ",min(fishcastr::grid_met_obs_1979_2019$tas$Dates$start)), tck = 0.02)
lines(grid_ERA5_1979_2019_Jan_raw$tas$Data[1:365],  col = "red")
lines(grid_ERA5_1979_2019_Jan_bc$tas$Data[1:365],  col = "blue")
legend("topleft",legend = c("raw ERA5","obs","BC ERA5"), col = c("red","black","blue"),lty = c(1,1,1), bty = "n")
dev.off()
knitr::include_graphics(path = "figure/pre_process_climate_data-1.png")

# ---------------------------------------------------------------------------------------------------------- #
# SEASONAL CLIMATE FORECAST (Re-forecasts and archived operational forecasts 1993 - 2019) ----
# BC grid (Re-forecasts and archived operational forecast years; 1993 - 2019)
# SPRING (see: data-raw/grid_SEAS5_reforecasts/grid_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_bc.R)
grid_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_bc <- fishcastr::grid_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_bc
#visualizeR::temporalPlot(... = grid_SEAS5_1993_2019_2_3_4_5_6_7_8_tas_pr_petH_bc$pr)
```

# (2) MODEL CHAIN DEVELOPMENT

## (2a) Model hydrology and water temperature

```{r model_hydrology_water_temp, eval=FALSE}
# ---------------------------------------------------------------------------------------------------------- #
# CALIBRATE CATCHMENT DISCHARGE MODEL (see: data_raw/model_GR4J_calibration.R) ----
GR4J_Burr_params_ERA5_bcc <- fishcastr::GR4J_Burr_params_ERA5_bcc

# ---------------------------------------------------------------------------------------------------------- #
# CALIBRATE WATER TEMPERATURE MODEL (see: data_raw/data_air_to_water_model.R) ----
air_to_water_Feeagh_params_ERA5_bcc <- fishcastr::air_to_water_Feeagh_params_ERA5_bcc

```

## (2b) Model proxy for migration preparedness

```{r model_proxy_preparedness, eval=FALSE}
# ---------------------------------------------------------------------------------------------------------- #
# CALIBRATE MIGRATION PREPAREDNESS MODEL (see: data_raw/model_physio_expmG_eel_calibration.R) ----
model_physio_expmG_inv_eel <- fishcastr::model_physio_expmG_inv_eel
```
